{% extends 'base.html.twig' %}

{% block title %}Infinite Scroll Demo - htmx-bundle{% endblock %}

{% block body %}
<div class="mb-6">
    <h1 class="text-3xl font-bold">Infinite Scroll</h1>
    <p class="text-base-content/70">Scroll down to load more items automatically. No JavaScript required!</p>
</div>

<div id="items-container" hx-indicator="#loading-indicator" class="space-y-4">
    {{ block('items') }}
</div>

<div id="loading-indicator" class="htmx-indicator flex justify-center py-8">
    <span class="loading loading-spinner loading-lg"></span>
</div>
{% endblock %}

{% block items %}
{% for item in items %}
<div class="card bg-base-100 shadow-xl"
    {% if loop.last and hasMore %}
        hx-get="{{ path('app_infinite_scroll', {'page': nextPage}) }}"
        hx-trigger="revealed"
        hx-swap="afterend"
        hx-replace-url="true"
    {% endif %}
>
    <div class="card-body">
        <h2 class="card-title">{{ item.title }}</h2>
        <p>{{ item.description }}</p>
        <div class="card-actions justify-end">
            <div class="badge badge-outline">Page {{ currentPage }}</div>
            <div class="badge badge-ghost">ID: {{ item.id }}</div>
        </div>
    </div>
</div>
{% endfor %}

{% if not hasMore %}
<div class="alert alert-info">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-current shrink-0 w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
    <span>You've reached the end! No more items to load.</span>
</div>
{% endif %}
{% endblock %}
