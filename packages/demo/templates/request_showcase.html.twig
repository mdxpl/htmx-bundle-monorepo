{% extends 'base.html.twig' %}

{% block title %}Request Showcase - htmx-bundle Demo{% endblock %}
{% block description %}Interactive demo of HtmxRequest properties: trigger, target, prompt, currentUrl, isBoosted, and history restoration.{% endblock %}

{% block stylesheets %}
<meta name="csrf-token" content="{{ csrf_token('htmx') }}">
<style>
    .result-box {
        padding: 0.75rem;
        background: var(--pico-card-sectionning-background-color);
        border-radius: var(--pico-border-radius);
        min-height: 50px;
        font-size: 0.875rem;
    }
    .prop-name { font-family: monospace; color: var(--pico-primary); }
    .prop-true { background: var(--pico-ins-color); color: #fff; }
    .prop-false { background: var(--pico-muted-border-color); }
    .prop-badge {
        display: inline-block;
        padding: 0.125rem 0.5rem;
        border-radius: var(--pico-border-radius);
        font-size: 0.75rem;
    }
</style>
{% endblock %}

{% block body %}
<article>
    <header>
        <h1>HtmxRequest Showcase</h1>
        <p>See what htmx sends in request headers. Click buttons on the left to update the table on the right.</p>
    </header>
</article>

<div class="grid">
    <div>
        <article>
            <header><strong>Trigger & Target</strong></header>
            <p><small>Different buttons set different <code>trigger</code> and <code>target</code> values</small></p>
            <div role="group">
                <button id="btn-alpha"
                        name="alpha-button"
                        hx-post="{{ path('app_request_showcase_request') }}"
                        hx-target="#action-result"
                        hx-swap="innerHTML">
                    id="btn-alpha"
                </button>
                <button class="secondary"
                        id="btn-beta"
                        name="beta-button"
                        hx-post="{{ path('app_request_showcase_request') }}"
                        hx-target="#action-result"
                        hx-swap="innerHTML">
                    id="btn-beta"
                </button>
                <button class="contrast"
                        id="btn-gamma"
                        hx-post="{{ path('app_request_showcase_request') }}"
                        hx-target="#action-result"
                        hx-swap="innerHTML">
                    id="btn-gamma"
                </button>
            </div>
        </article>

        <article>
            <header><strong>Prompt</strong></header>
            <p><small>Use <code>hx-prompt</code> to get user input - value appears in <code>prompt</code> property</small></p>
            <button class="outline"
                    id="prompt-btn"
                    hx-post="{{ path('app_request_showcase_prompt') }}"
                    hx-prompt="Enter your name:"
                    hx-target="#action-result"
                    hx-swap="innerHTML">
                Try hx-prompt
            </button>
        </article>

        <article>
            <header><strong>Current URL</strong></header>
            <p><small><code>currentUrl</code> shows browser URL when request was made</small></p>
            <div role="group">
                <button class="outline"
                        style="color: var(--pico-del-color); border-color: var(--pico-del-color);"
                        id="change-url-btn"
                        hx-post="{{ path('app_request_showcase_url') }}"
                        hx-target="#action-result"
                        hx-swap="innerHTML">
                    Change URL (replaceUrl)
                </button>
                <a href="{{ path('app_request_showcase') }}" role="button" class="outline">Reset URL</a>
            </div>
            <p><small>Click "Change URL", then click other buttons - currentUrl will show new URL</small></p>
        </article>

        <article hx-history="false">
            <header><strong>History Restoration</strong></header>
            <p><small>Click button to push URL, then browser back - <code>isForHistoryRestoration</code> = <kbd>true</kbd></small></p>
            <button class="outline"
                    style="color: var(--pico-primary); border-color: var(--pico-primary);"
                    id="history-btn"
                    hx-post="{{ path('app_request_showcase_history') }}"
                    hx-target="#action-result"
                    hx-swap="innerHTML">
                Push URL (then click browser back)
            </button>
            <p><small><code>hx-history="false"</code> disables htmx cache, forcing server request on back</small></p>
        </article>

        <article>
            <header><strong>Boosted Requests</strong></header>
            <p><small>Compare <code>hx-boost</code> link vs regular button - see <code>isBoosted</code> difference</small></p>
            <div role="group">
                <a href="{{ path('app_request_showcase_boosted') }}"
                   role="button"
                   style="background: var(--pico-ins-color);"
                   id="boosted-link"
                   hx-boost="true"
                   hx-target="#action-result"
                   hx-select="#boosted-response"
                   hx-swap="innerHTML">
                    Boosted Link (isBoosted=true)
                </a>
                <button class="outline"
                        id="regular-btn"
                        hx-post="{{ path('app_request_showcase_boosted') }}"
                        hx-target="#action-result"
                        hx-swap="innerHTML">
                    Regular Button (isBoosted=false)
                </button>
            </div>
        </article>
    </div>

    <div>
        <article>
            <header><strong>Response</strong></header>
            <div id="action-result" class="result-box">
                <small>Click any button to see the response</small>
            </div>
        </article>

        <article style="position: sticky; top: 1rem;">
            <header><strong>HtmxRequest Properties</strong></header>
            <p><small>Values from request headers - updates in real-time</small></p>

            <div id="request-info">
                {% block requestInfo %}
                <figure>
                    <table>
                        <thead>
                            <tr>
                                <th>Property</th>
                                <th>Value</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="prop-name">isHtmx</td>
                                <td><span class="prop-badge {{ htmx.isHtmx ? 'prop-true' : 'prop-false' }}">{{ htmx.isHtmx ? 'true' : 'false' }}</span></td>
                            </tr>
                            <tr>
                                <td class="prop-name">isBoosted</td>
                                <td><span class="prop-badge {{ htmx.isBoosted ? 'prop-true' : 'prop-false' }}">{{ htmx.isBoosted ? 'true' : 'false' }}</span></td>
                            </tr>
                            <tr>
                                <td class="prop-name">currentUrl</td>
                                <td style="font-family: monospace; font-size: 0.75rem; word-break: break-all;">{{ htmx.currentUrl ?? '(null)' }}</td>
                            </tr>
                            <tr>
                                <td class="prop-name">target</td>
                                <td style="font-family: monospace; font-size: 0.75rem;">{{ htmx.target ?? '(null)' }}</td>
                            </tr>
                            <tr>
                                <td class="prop-name">trigger</td>
                                <td style="font-family: monospace; font-size: 0.75rem;">{{ htmx.trigger ?? '(null)' }}</td>
                            </tr>
                            <tr>
                                <td class="prop-name">triggerName</td>
                                <td style="font-family: monospace; font-size: 0.75rem;">{{ htmx.triggerName ?? '(null)' }}</td>
                            </tr>
                            <tr>
                                <td class="prop-name">prompt</td>
                                <td style="font-family: monospace; font-size: 0.75rem;">{{ htmx.prompt ?? '(null)' }}</td>
                            </tr>
                            <tr>
                                <td class="prop-name">isForHistoryRestoration</td>
                                <td><span class="prop-badge {{ htmx.isForHistoryRestoration ? 'prop-true' : 'prop-false' }}">{{ htmx.isForHistoryRestoration ? 'true' : 'false' }}</span></td>
                            </tr>
                        </tbody>
                    </table>
                </figure>
                {% endblock %}
            </div>
        </article>
    </div>
</div>

{{ block('sourceCode') }}
{% endblock %}

{% block requestInfoOob %}
<div id="request-info" hx-swap-oob="true">
    <figure>
        <table>
            <thead>
                <tr>
                    <th>Property</th>
                    <th>Value</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="prop-name">isHtmx</td>
                    <td><span class="prop-badge {{ htmx.isHtmx ? 'prop-true' : 'prop-false' }}">{{ htmx.isHtmx ? 'true' : 'false' }}</span></td>
                </tr>
                <tr>
                    <td class="prop-name">isBoosted</td>
                    <td><span class="prop-badge {{ htmx.isBoosted ? 'prop-true' : 'prop-false' }}">{{ htmx.isBoosted ? 'true' : 'false' }}</span></td>
                </tr>
                <tr>
                    <td class="prop-name">currentUrl</td>
                    <td style="font-family: monospace; font-size: 0.75rem; word-break: break-all;">{{ htmx.currentUrl ?? '(null)' }}</td>
                </tr>
                <tr>
                    <td class="prop-name">target</td>
                    <td style="font-family: monospace; font-size: 0.75rem;">{{ htmx.target ?? '(null)' }}</td>
                </tr>
                <tr>
                    <td class="prop-name">trigger</td>
                    <td style="font-family: monospace; font-size: 0.75rem;">{{ htmx.trigger ?? '(null)' }}</td>
                </tr>
                <tr>
                    <td class="prop-name">triggerName</td>
                    <td style="font-family: monospace; font-size: 0.75rem;">{{ htmx.triggerName ?? '(null)' }}</td>
                </tr>
                <tr>
                    <td class="prop-name">prompt</td>
                    <td style="font-family: monospace; font-size: 0.75rem;">{{ htmx.prompt ?? '(null)' }}</td>
                </tr>
                <tr>
                    <td class="prop-name">isForHistoryRestoration</td>
                    <td><span class="prop-badge {{ htmx.isForHistoryRestoration ? 'prop-true' : 'prop-false' }}">{{ htmx.isForHistoryRestoration ? 'true' : 'false' }}</span></td>
                </tr>
            </tbody>
        </table>
    </figure>
</div>
{% endblock %}

{% block actionResult %}
<div style="color: var(--pico-ins-color);">
    <strong>Request received!</strong>
    trigger={{ htmx.trigger ?? 'null' }}, triggerName={{ htmx.triggerName ?? 'null' }}, target={{ htmx.target ?? 'null' }}
</div>
{% endblock %}

{% block promptResult %}
<div style="color: var(--pico-ins-color);">
    <strong>Prompt value:</strong> {{ promptValue }}
</div>
{% endblock %}

{% block urlResult %}
<div style="color: var(--pico-del-color);">
    <strong>URL replaced:</strong> {{ newUrl }}<br>
    <small>Click other buttons - currentUrl will show this new URL</small>
</div>
{% endblock %}

{% block historyResult %}
<div style="color: var(--pico-primary);">
    <strong>URL pushed:</strong> {{ newUrl }}<br>
    <small>Now click browser back to see isForHistoryRestoration = true</small>
</div>
{% endblock %}

{% block boostedResult %}
<div id="boosted-response" style="color: var(--pico-ins-color);">
    <strong>Boosted request received!</strong> isBoosted = {{ htmx.isBoosted ? 'true' : 'false' }}
</div>
{% endblock %}

{% block sourceCode %}
{% include '_source_code.html.twig' with {controller: 'RequestShowcaseController.php', template: 'request_showcase.html.twig'} %}
{% endblock %}
